# 注意：本文件仅在本机使用，请勿提交到代码仓库或公开分享
# 已为 OKX 模拟盘（Demo Trading）与合约（USDT 本位永续）测试给出合理默认值
# 如需实盘务必更换为全新密钥并将 OKX_SIMULATED=0（本文件默认=1，只有模拟盘）

##########################
# 1) 执行与熔断（交易主控）
##########################
# 运行模式：mock（本地模拟，不触发交易所）/ real（调用交易所）/ paused（暂停）
EXEC_MODE=real
# 外部控制文件（程序运行时可动态切换三态）
EXEC_CONTROL_FILE=data/exec_switch.json
# 启用 HTTP 管理接口（可在浏览器中查看状态/切换模式）
EXEC_HTTP_ENABLED=1
# HTTP 管理接口绑定主机
EXEC_HTTP_HOST=127.0.0.1
# HTTP 管理接口端口
EXEC_HTTP_PORT=8088
# 账户基准权益（USD，用于熔断阈值参考）
BASE_EQUITY_USD=10000
# 单日最大亏损比例（超过则暂停）
DAILY_MAX_LOSS_PCT=0.03
# 单笔最大亏损比例（超过则暂停）
SINGLE_TRADE_MAX_LOSS_PCT=0.01
# 将价格变化近似折算为损益名义规模（越小越保守）
RISK_NOTIONAL_USD=100
# 回测对齐开关（1=对齐回测逻辑：仅市价单，TP/SL 由策略信号触发；0=正常实盘逻辑）
EXEC_ALIGN_BACKTEST=0

##########################
# 2) 策略与运行开关
##########################
# 策略下单基础数量（现货=币数量；合约=张数，建议从 1 张起步）
TRADE_SIZE=1
# MA 策略时间框架（如 1min/5min/15min）
MA_TIMEFRAME=1min
# 快速均线周期
MA_FAST=3
# 慢速均线周期
MA_SLOW=5
# 突破判定回看窗口（近 N 根最高/最低）
MA_BREAKOUT_N=3
# 突破缓冲百分比（>0 更稳健）
MA_BREAKOUT_BUFFER=0.0
# 计算所需的回看 K 线数量（越大越稳健，越慢）
MA_LOOKBACK_BARS=9
# 下单类型：market（市价）/ limit（限价）
MA_ORDER_TYPE=market
# 固定百分比止损（为空则由其他规则控制）
MA_STOP_LOSS_PCT=0.005
# 策略轮询周期（秒）
MA_POLL_SEC=20
# 策略冷却时间（秒，避免频繁下单）
MA_COOLDOWN_SEC=60
# 是否优先使用成交(trades)构造 K 线（数据充分时更贴近真实）
MA_PREFER_TRADES=1

# 组件开关：1=启用，0=关闭
COLLECTOR_ENABLED=1
MONITOR_ENABLED=1
AI_GATE_ENABLED=0

# —— 高级策略参数（可选，默认关闭；需要时去掉行首 # 并自行设值）——
# # MACD 快/慢/信号周期（未设置时将使用默认/回退值）
# MA_MACD_FAST=12
# MA_MACD_SLOW=26
# MA_MACD_SIGNAL=9
# # 布林带参数：周期与 K 倍数
# MA_BB_PERIOD=20
# MA_BB_K=2.0
# # RSI 参数与买卖阈值
# MA_RSI_PERIOD=14
# MA_RSI_BUY=55
# MA_RSI_SELL=45
# # AROON 参数与买卖阈值
# MA_AROON_PERIOD=25
# MA_AROON_BUY=70
# MA_AROON_SELL=30
# # 入场确认最少 K 数
# MA_CONFIRM_MIN=3
# # ATR 倍数止损；以及品种级固定百分比止损
# MA_ATR_N=2.0
# MA_STOP_LOSS_PCT_BTC=0.03
# MA_STOP_LOSS_PCT_ETH=0.04
# # 分级止盈参数：R 倍数与对应平仓比例
# MA_TP_R1=1.0
# MA_TP_R2=2.0
# MA_TP_FRAC1=0.3
# MA_TP_FRAC2=0.3
# # ATR 移动止损倍数
# MA_TP_TRAIL_ATR=1.5
# # RSI 技术止盈触发阈值与建议比例
# MA_RSI_TP_HIGH=80
# MA_RSI_TP_LOW=20
# MA_RSI_TP_FRAC=0.2
# # 全局禁用止损（仅用于测试/演示，1=禁用止损参数传递）
# DISABLE_SL=0

##########################
# 3) OKX REST（模拟盘 + 合约/现货）
##########################
# 基础域名（模拟盘同样使用正式域名，区别在于请求头）
OKX_BASE_URL=https://www.okx.com
# API Key（建议仅用于模拟盘，实盘请务必更换为新密钥）
OKX_API_KEY=ea2f78de-a081-42d0-816c-06e98496ecdc
# API Secret（建议仅用于模拟盘，实盘请务必更换为新密钥）
OKX_API_SECRET=C69E1CB2456360D0B8B5A1110154FBBE
# Passphrase（创建 API Key 时设置的口令，务必填写正确）
OKX_API_PASSPHRASE=Wgy147147147...
# 开启 OKX 模拟盘请求头（x-simulated-trading: 1）
OKX_SIMULATED=1
# 交易模式：合约/杠杆使用 cross（全仓）或 isolated（逐仓）；现货用 cash
OKX_TD_MODE=cross
# 现货下单计量方式：base_ccy/quote_ccy（合约模式此项无效，保持注释）
# OKX_TGT_CCY=base_ccy

##########################
# 4) 行情订阅（WebSocket）
##########################
# OKX 公共行情 WS 地址
OKX_WS_PUBLIC=wss://ws.okx.com:8443/ws/v5/public
# 订阅的交易对（合约建议 *-USDT-SWAP；多个用英文逗号分隔）
INSTRUMENTS=ETH-USDT-SWAP

##########################
# 5) 数据库（PostgreSQL/TimescaleDB）
##########################
# 数据库主机名
DB_HOST=localhost
# 数据库端口
DB_PORT=15432
# 数据库名
DB_NAME=crypto
# 数据库用户名
DB_USER=postgres
# 数据库密码
DB_PASSWORD=123456
# SSL 模式（disable/prefer/require）
DB_SSLMODE=prefer

##########################
# 6) 审计与结构化日志
##########################
# 是否启用审计
AUDIT_ENABLED=1
# 是否写入本地 JSONL 文件
AUDIT_TO_FILE=1
# 是否写入数据库 audit_logs 表
AUDIT_TO_DB=1
# 审计日志目录（将自动按天滚动）
AUDIT_DIR=data/audit
# 审计文件前缀
AUDIT_FILE_PREFIX=audit

##########################
# 7) 告警渠道（默认关闭，可按需开启）
##########################
# 启用 Telegram 告警
TG_ENABLED=0
# Telegram 机器人 Token（启用后必填）
TG_BOT_TOKEN=
# Telegram Chat ID（用户或群组）
TG_CHAT_ID=
# 启用 Slack 告警
SLACK_ENABLED=0
# Slack Bot Token（启用后必填）
SLACK_BOT_TOKEN=
# Slack 频道名（如 #trading-alerts）
SLACK_CHANNEL=

##########################
# 8) 监控与可视化（轻量级）
##########################
# 监控轮询周期（秒）
MONITOR_POLL_SEC=1
# 监控标的（为空则复用 WS 的 INSTRUMENTS；多个用英文逗号分隔）
# MONITOR_INSTRUMENTS=BTC-USDT-SWAP
# 是否启用 Web UI（当前仅终端输出，预留）
MONITOR_WEB_UI=0

##########################
# 9) AI 模块（默认本地或关闭远端调用）
##########################
# AI 提供方：local（本地）/ openai（OpenAI 兼容 API）
AI_PROVIDER=local
# 本地模型 ID（仅在 provider=local 时使用）
AI_LOCAL_MODEL=Qwen/Qwen2.5-0.5B-Instruct
# OpenAI 兼容 API 地址（仅在 provider=openai 时使用）
OPENAI_BASE_URL=https://api.openai.com
# OpenAI API Key（仅在 provider=openai 时使用）
OPENAI_API_KEY=
# OpenAI 模型名称（如 gpt-4o-mini 等）
OPENAI_MODEL=gpt-4o-mini
# 采样温度（越小越保守）
AI_TEMPERATURE=0.2
# 生成最大 Token 数
AI_MAX_TOKENS=512
# 仅在触发异常时调用大模型（1=是）
AI_ONLY_ANOMALY=1
# 异常触发阈值：价格跳变百分比
AI_TH_PRICE_JUMP=0.01
# 异常触发阈值：巨鲸转账（USD）
AI_TH_WHALE_USD=1000000
# 异常触发阈值：情绪骤降（0-1）
AI_TH_SENT_DROP=0.3

##########################
# 10) 告警阈值（系统内置监控）
##########################
# 是否启用内置告警
ALERTS_ENABLED=1
# 价格瞬时跳变阈值（相对比例）
ALERT_PRICE_JUMP_PCT=0.02
# 盘口延迟判定（秒）
ALERT_STALE_BOOK_SEC=10
# 交易失败监控窗口（秒）
ALERT_TRADE_FAIL_WIN=60
# 同类告警限频（秒）
ALERT_RATE_LIMIT_SEC=60

##########################
# 11) 风控（事前限额与滑点约束）
##########################
# 每个交易对最大持仓名义金额（USD）
RISK_MAX_POSITION_USD=20000000
# 每个交易对允许的最大未完成订单数
RISK_MAX_OPEN_ORDERS=100
# 单次下单占用权益最大比例（0-1）
RISK_SINGLE_ORDER_MAX_PCT_EQUITY=1
# 最大允许滑点（相对最优价/中间价比例）
RISK_MAX_SLIPPAGE_PCT=0.02
# 单笔最大允许亏损（USD）
RISK_MAX_SINGLE_TRADE_LOSS_USD=8000
# 单日最大允许亏损（USD）
RISK_MAX_DAILY_LOSS_USD=200000

##########################
# 12) 交易纪律集中配置（JSON，可选）
##########################
# 交易纪律 JSON 文件路径（为空则使用默认 mvp/rules.json）
# RULES_CONFIG_FILE=mvp/rules.json

##########################
# 13) 测试脚本专用参数（可选，用于 mvp/scripts/send_test_order.py）
##########################
# 测试下单交易对（如 BTC-USDT 或 *-USDT-SWAP）
# TEST_INST_ID=BTC-USDT
# 测试方向（buy/sell）
# TEST_SIDE=buy
# 测试数量（现货=币数量；合约=张数）
# TEST_SIZE=0.0001
# 测试参考价（仅用于脚本内部模拟计算/风控评估）
# TEST_REF_PX=30000
# 测试下单交易模式（cash/cross/isolated），默认复用 OKX_TD_MODE
# TEST_TD_MODE=cash